# ‚úÖ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –î–ï–ü–õ–û–Æ –ù–ê STAGE

## üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–æ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|--------|
| **Kubernetes –∫–ª–∞—Å—Ç–µ—Ä** | ‚úÖ | –î–æ—Å—Ç—É–ø–µ–Ω (31.129.105.180:6443) |
| **Docker** | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç (v28.1.1) |
| **kubectl** | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| **Secrets** | ‚úÖ | ghcr-secret –∏ openai-secret —Å—É—â–µ—Å—Ç–≤—É—é—Ç |
| **Deployment** | ‚ö†Ô∏è | –°—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ pods –≤ ImagePullBackOff |
| **–ú–∞–Ω–∏—Ñ–µ—Å—Ç—ã** | ‚úÖ | –ì–æ—Ç–æ–≤—ã (kustomize) |
| **Dockerfile** | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è production |

## üîç –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–í–µ—Ç–∫–∞:** `unit-profile`  
**–ù–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:** 6 —Ñ–∞–π–ª–æ–≤  
**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π deployment:** `dsp-stage-deployment` (0/2 pods ready, ImagePullBackOff)

**–ü—Ä–æ–±–ª–µ–º–∞:** Pods –Ω–µ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—Ä–∞–∑, –≤–µ—Ä–æ—è—Ç–Ω–æ –æ–±—Ä–∞–∑ —É—Å—Ç–∞—Ä–µ–ª –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

## üöÄ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –í–∞—Ä–∏–∞–Ω—Ç 1: –î–µ–ø–ª–æ–π —Å —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
# 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
git add .
git commit -m "Fix: Critical issues resolved - layoutId bow, layout structure, ThemeButton, tsconfig, Toast integration"

# 2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ stage –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å merge
git checkout stage
git merge unit-profile --no-edit
# –ò–õ–ò –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –±–µ–∑ merge:
git stash  # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git checkout stage
git stash pop  # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π
./deploy-stage.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–µ–ø–ª–æ–π —Å –≤–µ—Ç–∫–∏ stage (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ —Ç–∞–º)

```bash
# 1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ stage
git checkout stage

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π
./deploy-stage.sh
```

## üìù –ß—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

1. ‚úÖ –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ —Å —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º
2. ‚úÖ –ü—É—à –æ–±—Ä–∞–∑–∞ –≤ GHCR: `ghcr.io/themacroeconomicdao/decentralized-social-platform/dsp-stage:latest`
3. ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ kustomize
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ deployment —Å –Ω–æ–≤—ã–º –æ–±—Ä–∞–∑–æ–º
5. ‚úÖ –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ pods (–º–∞–∫—Å–∏–º—É–º 5 –º–∏–Ω—É—Ç)
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ deployment, service –∏ ingress

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ GHCR:** –ù—É–∂–Ω–æ –±—ã—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –¥–ª—è push –æ–±—Ä–∞–∑–∞
   ```bash
   echo $GITHUB_TOKEN | docker login ghcr.io -u USERNAME --password-stdin
   ```

2. **–¢–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:** –ï—Å—Ç—å –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å —á—Ç–æ —Å –Ω–∏–º–∏ –¥–µ–ª–∞—Ç—å

3. **–í–µ—Ç–∫–∞ stage:** –ü–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, stage –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è –∏–∑ –≤–µ—Ç–∫–∏ `stage`

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π

**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

```bash
# 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "Fix: Project fixes - all critical issues resolved"

# 2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ stage
git checkout stage

# 3. –°–º–µ—Ä–∂–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
git merge unit-profile --no-edit

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π
./deploy-stage.sh
```

**–ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å stage —Å —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º –∏–∑ stage –≤–µ—Ç–∫–∏:**

```bash
git checkout stage
./deploy-stage.sh
```

## üìä –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:**
```bash
kubectl get pods -l app=dsp-stage,environment=stage -n default
kubectl logs -l app=dsp-stage,environment=stage -n default --tail=50
```

**URL:** https://stage.dsp.build.infra.gyber.org

---

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ:
1. –†–µ—à–∏—Ç—å —Å –≤–µ—Ç–∫–æ–π (stage –∏–ª–∏ merge)
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `./deploy-stage.sh`

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ stage!** üöÄ

