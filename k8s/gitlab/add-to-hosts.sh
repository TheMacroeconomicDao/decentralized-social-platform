#!/bin/bash

echo "üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ gitlab.gyber.org –≤ /etc/hosts"
echo ""

GITLAB_IP="65.108.15.30"
HOSTS_FILE="/etc/hosts"
HOST_ENTRY="$GITLAB_IP gitlab.gyber.org"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∑–∞–ø–∏—Å—å
if grep -q "gitlab.gyber.org" "$HOSTS_FILE" 2>/dev/null; then
    echo "‚úÖ –ó–∞–ø–∏—Å—å –¥–ª—è gitlab.gyber.org —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:"
    grep "gitlab.gyber.org" "$HOSTS_FILE"
    echo ""
    echo "üí° –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å, —É–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é –∑–∞–ø–∏—Å—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–Ω–æ–≤–∞"
    exit 0
fi

echo "‚ûï –î–æ–±–∞–≤–ª—è—é –∑–∞–ø–∏—Å—å: $HOST_ENTRY"
echo ""
echo "‚ö†Ô∏è  –ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
echo ""

# –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å
if sudo sh -c "echo '$HOST_ENTRY' >> $HOSTS_FILE"; then
    echo "‚úÖ –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!"
    echo ""
    echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
    echo "üåê GITLAB –î–û–°–¢–£–ü–ï–ù"
    echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
    echo ""
    echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
    echo ""
    echo "1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ (Cmd+R –∏–ª–∏ Ctrl+R)"
    echo ""
    echo "2. –û—Ç–∫—Ä–æ–π—Ç–µ: http://gitlab.gyber.org"
    echo "   (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ http://, –Ω–µ https:// –ø–æ–∫–∞ SSL –Ω–µ –≥–æ—Ç–æ–≤)"
    echo ""
    echo "3. –í–æ–π–¥–∏—Ç–µ –≤ GitLab:"
    echo "   –õ–æ–≥–∏–Ω:    root"
    echo "   –ü–∞—Ä–æ–ª—å:   73/sV+RgIpHNd9Go7w0SJoTGJoLvl71P3NwUDh2nUUk="
    echo ""
    echo "4. –°–æ–∑–¥–∞–π—Ç–µ Personal Access Token:"
    echo "   Settings ‚Üí Access Tokens"
    echo ""
    echo "5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω:"
    echo "   echo '–≤–∞—à-—Ç–æ–∫–µ–Ω' > k8s/gitlab/.gitlab-token"
    echo ""
    echo "6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:"
    echo "   ./k8s/gitlab/setup-env-now.sh"
    echo ""
    echo "‚ö†Ô∏è  –í–ê–ñ–ù–û: –≠—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞!"
    echo "   –î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ DNS –∑–∞–ø–∏—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:"
    echo "   gitlab.gyber.org -> $GITLAB_IP"
    echo ""
else
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å"
    echo ""
    echo "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é:"
    echo "   sudo nano /etc/hosts"
    echo "   –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É: $HOST_ENTRY"
    exit 1
fi

