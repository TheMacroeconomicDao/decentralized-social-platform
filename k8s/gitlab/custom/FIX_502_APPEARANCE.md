# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 502 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ Appearance

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø –∏–ª–∏ favicon –≤ **Admin Area ‚Üí Appearance** –ø–æ–ª—É—á–∞–µ—Ç–µ:
- `502 Bad Gateway`
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

## –ü—Ä–∏—á–∏–Ω–∞

–û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞:
1. **–ú–∞–ª—ã–π –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏** –≤ nginx (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1MB)
2. **–¢–∞–π–º–∞—É—Ç—ã** –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
3. **Puma worker timeout** —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π

## –†–µ—à–µ–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```bash
./k8s/gitlab/custom/fix-502-appearance.sh
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
kubectl apply -f k8s/gitlab/gitlab-deployment.yaml
```

### –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ:

1. **–£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç –∑–∞–≥—Ä—É–∑–∫–∏**: `nginx['client_max_body_size'] = '10m'`
2. **–£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã**:
   - `gitlab_rails['max_request_duration_seconds'] = 300`
   - `puma['worker_timeout'] = 300`
   - `gitlab_workhorse['shutdown_timeout'] = '300s'`

## –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

1. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã** –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ GitLab
2. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** Appearance –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–Ω–æ–≤–∞**

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- ‚úÖ –õ–∏–º–∏—Ç –∑–∞–≥—Ä—É–∑–∫–∏: 10MB (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è SVG —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –¢–∞–π–º–∞—É—Ç—ã: 300 —Å–µ–∫—É–Ω–¥
- ‚úÖ –û—à–∏–±–∫–∞ 502 –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ 502 –≤—Å–µ –µ—â–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞** (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å SVG)
2. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ API** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
3. **–ü–æ–¥–æ–∂–¥–∞—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ, GitLab –µ—â–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–û—à–∏–±–∫–∞ `Permissions-Policy header: Unrecognized feature: 'browsing-topics'` - —ç—Ç–æ **–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞**, –Ω–µ –æ—à–∏–±–∫–∞. –û–Ω–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∞.




